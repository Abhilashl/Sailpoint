<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE Rule PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<Rule created="1481841601006" id="8a85948558c3f169015904a469ee50b6" language="beanshell" modified="1484248575965" name="ACI - Identity Information Report Rule" type="ReportCustomizer">
  <Description>
    This rule populates a form with fields for the standard and extended identity attributes.
  </Description>
  <Signature returnType="Map">
    <Inputs>
      <Argument name="locale">
        <Description>
          The current user's locale
        </Description>
      </Argument>
      <Argument name="report">
        <Description>
          The base report
        </Description>
      </Argument>
    </Inputs>
  </Signature>
  <Source>
       
        import sailpoint.object.*;
        import sailpoint.reporting.ReportingLibrary;

        ObjectConfig identityConfig = ObjectConfig.getObjectConfig(Identity.class);
        List standardAttributes = new ArrayList();
        standardAttributes.add(identityConfig.getObjectAttributeMap().get("firstname"));
        standardAttributes.add(identityConfig.getObjectAttributeMap().get("lastname"));
        standardAttributes.add(identityConfig.getObjectAttributeMap().get("displayName"));
        standardAttributes.add(identityConfig.getObjectAttributeMap().get("email"));
        standardAttributes.add(identityConfig.getObjectAttributeMap().get("manager"));
        standardAttributes.add(identityConfig.getObjectAttributeMap().get("inactive"));

        ReportingLibrary.addAttributes(context, report, Identity.class, standardAttributes, null,
          "Identity Attributes", locale, "id");

        List extendedAttrs = new ArrayList();
        for(ObjectAttribute att : identityConfig.getSearchableAttributes()){
          if (!att.isStandard())
            if ( !att.name.equals("identityType") ) 
              if ( !att.name.equals("irsStatus") )
                  if (!att.name.equals("company") ) 
                      if ( !att.name.equals("personType"))
            						if ( !att.name.equals("country"))
            						   if ( !att.name.equals("division"))
            								  if ( !att.name.equals("location"))
                          extendedAttrs.add(att);
        }

        for(ObjectAttribute att : identityConfig.getMultiAttributeList()){
            if ( !att.name.equals("identityType") ) 
              if ( !att.name.equals("irsStatus") )
                  if (!att.name.equals("company") ) 
                      if ( !att.name.equals("personType"))
                         if ( !att.name.equals("country"))
            						   if ( !att.name.equals("division"))
            								  if ( !att.name.equals("location"))
                          extendedAttrs.add(att);
        }

        ReportingLibrary.addAttributes(context, report, Identity.class, extendedAttrs, null, "Identity Extended Attributes", locale, "id");
</Source>
</Rule>
